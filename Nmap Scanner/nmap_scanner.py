import nmap

scanner = nmap.PortScanner()

ip_address = input("Input the IP to scan: ")

scan = input("""\nSelect the type of scan to run
1) SYN ACK Scan
2) UDP Scan
3) Comprehensive Scan

>""")

match scan:
    case "1":
        print("Nmap version: ", scanner.nmap_version())
        print("Results for: ", ip_address)
        scanner.scan(ip_address, "1-1024", "-v -sS")
        print(scanner.scaninfo())
        print("Status: ", scanner[ip_address].state())
        print(scanner[ip_address].all_protocols())
        print("Open ports: ", scanner[ip_address]['tcp'].keys())

    case "2":
        print("Nmap version: ", scanner.nmap_version())
        print("Results for: ", ip_address)
        scanner.scan(ip_address, "1-1024", "-v -sU")
        print(scanner.scaninfo())
        print("Status: ", scanner[ip_address].state())
        print(scanner[ip_address].all_protocols())
        print("Open ports: ", scanner[ip_address]['udp'].keys())

    case "3":
        print("Nmap version: ", scanner.nmap_version())
        print("Results for: ", ip_address)
        scanner.scan(ip_address, "1-1024", "-v -sS -sV -sC -A -O")
        print(scanner.scaninfo())
        print("Status: ", scanner[ip_address].state())
        print(scanner[ip_address].all_protocols())
        print("Open ports: ", scanner[ip_address]['tcp'].keys())

    case _:
        print("Invalid option")